### 16:08 - Define markdown schema for multiple cards [openai/gpt-5-codex]

**User Prompt:**
Define a schema/specification for describing multiple cards in a markdown file. A level 2 heading containing the name, attack/defense and rarity. an image link for the image url

**Issues Encountered:**
- No existing dedicated markdown card schema document was present in `docs/design/`.

**Decisions Made:**
- Added a dedicated design document at `docs/design/card-markdown-schema.md`.
- Defined one strict, repeatable two-line card pattern (`##` heading + image link) to keep parsing and authoring simple.
- Included explicit formatting rules and a multi-card example for implementation clarity.

**Technical Info Consulted:**
- `AGENTS.md`
- `docs/design/datamodel.md`

**Assumptions Made:**
- Rarity values are free-form non-empty strings, with common examples listed.
- Image URLs should be absolute `https://` URLs for reliability across environments.

**Other Notes:**
- The schema is documentation-only and does not yet enforce validation in application code.

### 16:19 - Remove explicit ATK/DEF keywords from card heading schema [openai/gpt-5-codex]

**User Prompt:**
remove the ATK DEF keywords, they should be implied

**Issues Encountered:**
- None.

**Decisions Made:**
- Updated the heading schema to `## <Name> | <Attack>/<Defense> | <Rarity>`.
- Added a rule clarifying positional meaning: first value is attack, second is defense.
- Updated all examples to the compact implied format.

**Technical Info Consulted:**
- `docs/design/card-markdown-schema.md`
- `AGENTS.md`

**Assumptions Made:**
- The slash-separated numeric pair remains unambiguous for both humans and parsers.

**Other Notes:**
- This change preserves all prior information while reducing heading verbosity.

### 16:32 - Add markdown card parser and extend card model metadata [openai/gpt-5-codex]

**User Prompt:**
create a parser and tests for this schema, extend the card model to include image and source file

**Issues Encountered:**
- The markdown schema allows labels like `Epic`, but the runtime rarity model currently only supports `common`, `uncommon`, `rare`, and `legendary`.

**Decisions Made:**
- Added `parseCardsMarkdown(markdown, sourceFile)` to parse multiple card entries from markdown headings and image lines.
- Enforced strict heading and image-line parsing with explicit error messages for malformed entries.
- Added `image` and `sourceFile` as optional fields to the shared `Card` interface and Zod schema.
- Parser output fills gameplay metadata defaults (`types`, `keywords`, `behaviors`) to remain compatible with the existing `Card` model and validators.
- Added dedicated parser unit tests for success cases and validation failures.
- Updated schema docs to list runtime-supported rarity values (`Common`, `Uncommon`, `Rare`, `Legendary`).

**Technical Info Consulted:**
- `docs/design/card-markdown-schema.md`
- `ui/src/shared/models/card.ts`
- `ui/src/shared/models/card.schema.ts`
- `ui/src/shared/models/models.test.ts`
- `AGENTS.md`

**Assumptions Made:**
- Parsed markdown card data should integrate directly with the existing `Card` model shape.
- Card IDs generated from names should be slug-based and de-duplicated deterministically within a file.

**Other Notes:**
- Rarity values outside the current model enum are rejected by the parser and surfaced with line-specific errors.

### 16:36 - Add themed markdown card definition files [openai/gpt-5-codex]

**User Prompt:**
in the cards subfolder create themed card definition markdown files using this schema. Each file should have a theme with several creatures. Avoid boring tropes, make it creative.

**Issues Encountered:**
- No existing `cards/` subfolder was present in the repository.

**Decisions Made:**
- Created a new root-level `cards/` directory for markdown card definition sources.
- Added three themed files with multiple entries each:
- `cards/Glass-Tide-Consortium.md`
- `cards/Municipal-Nocturne.md`
- `cards/Skylab-Bestiary.md`
- Used parser-compatible schema blocks (`## <Name> | <Attack>/<Defense> | <Rarity>` + image line) for every card.
- Chose unusual settings and creature concepts to avoid generic fantasy tropes while keeping rarity values within supported runtime constraints.

**Technical Info Consulted:**
- `docs/design/card-markdown-schema.md`
- `ui/src/shared/models/card-markdown.parser.ts`
- `AGENTS.md`

**Assumptions Made:**
- The requested "cards subfolder" refers to a repository-level folder intended for source card markdown files.
- Placeholder CDN URLs are acceptable for initial content authoring.

**Other Notes:**
- Card entries are parse-ready for `parseCardsMarkdown(markdown, sourceFile)`.

### 16:59 - Load UI card library from markdown via import.meta.glob [openai/gpt-5-codex]

**User Prompt:**
use the created markdown files to setup the card library in the UI. Use vite's import.meta.glob facility to import all markdown files. Remove the old @file:cards.ts example files.[@cards.ts](file:///C:/projects/fantasy-auto-battle/ui/src/shared/models/cards.ts)

**Issues Encountered:**
- Existing combat snapshots and one combat unit test assumed fixed stats/IDs from the removed hardcoded example cards.

**Decisions Made:**
- Replaced hardcoded card examples in `ui/src/shared/models/cards.ts` with eager markdown imports using `import.meta.glob("../../../../cards/*.md", { eager: true, query: "?raw", import: "default" })`.
- Parsed each markdown file through `parseCardsMarkdown` and derived `set` from source filename for compatibility with existing filtering APIs.
- Added deterministic sorting of loaded cards and duplicate ID detection across files.
- Updated model tests that relied on old sample cards to assert markdown-library behavior instead.
- Refactored the fragile "mutual faint" combat test to use explicit local test cards and regenerated combat snapshots for the new library data.

**Technical Info Consulted:**
- `ui/src/shared/models/cards.ts`
- `ui/src/shared/models/card-markdown.parser.ts`
- `ui/src/shared/models/models.test.ts`
- `ui/src/shared/combat/battle-computer.test.ts`
- `AGENTS.md`

**Assumptions Made:**
- Repository-level `cards/*.md` files are the intended source-of-truth for UI card content.
- `set` derived from markdown filename is an acceptable replacement for the previous hardcoded `core` set field.

**Other Notes:**
- `../tool-tool.exe pnpm run check` passes after snapshot updates.

### 17:13 - Add flavor text support to markdown card definitions and parser [openai/gpt-5-codex]

**User Prompt:**
Add flavour text to the card text md files and parse them into the card model

**Issues Encountered:**
- Existing markdown schema documentation only described heading and image lines, so flavor support needed explicit spec updates.

**Decisions Made:**
- Extended markdown schema to support optional flavor text lines as markdown blockquotes (`> ...`) directly below each image line.
- Updated `parseCardsMarkdown` to parse optional flavor text and map it to `Card.description`.
- Added flavor text content for every card entry in all existing themed markdown files.
- Updated parser tests to verify flavor extraction and backward-compatible parsing when flavor text is absent.

**Technical Info Consulted:**
- `docs/design/card-markdown-schema.md`
- `ui/src/shared/models/card-markdown.parser.ts`
- `ui/src/shared/models/card-markdown.parser.test.ts`
- `cards/Glass-Tide-Consortium.md`
- `cards/Municipal-Nocturne.md`
- `cards/Skylab-Bestiary.md`
- `AGENTS.md`

**Assumptions Made:**
- Flavor text should populate the already-existing optional `description` field on `Card`.
- Single-line flavor text is sufficient for current card content needs.

**Other Notes:**
- Flavor text remains optional per card entry.
